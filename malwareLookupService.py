from flask import Flask
import csv
import re
import pandas

app = Flask(__name__)

@app.route('/')
def say_welcome():
   return '<h1>Welcome!</h1>'
@app.route('/<path:path>')
def check_url(path):
    match = re.search("(v1/urlinfo/)(.*)", path)
    df = pandas.read_csv('url_database.csv')
    try:
        for idx in df.index:
            if match.group(2) == df['malware_urls'][idx]:
                return '<h1>The URL is known Malware. DO NOT PROCEED!!!!!</h1>'

        return '<h1>The URL is safe to proceed.</h1>'
    except:
        return '<h1>Enter URL in proper format as per problem statement.</h1>'
